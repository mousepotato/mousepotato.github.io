---
layout: post
title:  How to crack the master lock  
tags:
- Technique 
---

如何破解master lock的密码


## 原委

最近游泳不小心把爱锁丢失，无奈看到地上有一个废弃的master lock，捡了回来，死马当活马医吧。

![master lock](/assets/images/2013/04/29/master_lock.png)

## 破解准备知识
1. Master lock 密码转盘有40个数字 (0-39)，3个密码，采取暴力的手段是无法破解的。
2. 密码转盘有40个数字 (0-39)可以分为4组 （0-10，11-20，21-30，31-0），明白分组的概念有助于加速破解
3. 了解master lock如何开锁。（已经知道密码的情况下）参看 [eHow](http://www.ehow.com/how_4810869_open-master-combination-lock.html)。具体方法是：

`1. 将master lock正面朝向你，不要放反了`

`2. 将密码转盘顺时针转3整圈，注意，在第三圈未转完的时候将密码的第一位数字对准锁正上方的红点。`

`3. 现在开始逆时针转动转盘，要让密码的第一位数字通过正上方的红点一次，然后让密码的第二位数字停留在红点下方`

`4. 现在开始顺时针旋转密码，直接转到密码的第三位数字，将其放在红点下方。`

`5. 拉动锁杆，可以开锁了，如何不行的话，在知道正确密码的情况下，重复1-4步骤。`


## 破解第三位数字
1. 初始化master lock

	`顺时针转到密码转盘4-5圈，使锁复位`
2. 将锁盘的数字0正对锁上方的红色小点
3. 用手用力拉锁杆，顺时针从0开始转动转盘。

	`在0-10的数字之间，你能找到在3个数字出，转盘会被卡住，转动很困难，记下这三个数字，如果转盘卡在某两个数字之间，比如6和7之间，就记下6.5`

4. 重复第三个步骤，依次在11-20，21-30，31-0之间各找到三个数字。

5. 记下这12个数字，这十二个数字有规律的：

	`（1）当中会有5个数字是整数，7个小数`
	
	`（2）5个整数中会有4个整数结尾数字相同`
	
	`（3）找出那个结尾不同的数字，它就是你的密码中的第三位数字！！！`
	

## 破解第一位数字
1. 找到密码的第三位数字后，将它除以4取余数，结果会是0，1，2，和3中的一个。比如我的第三位数字是35，那么除以4后余数是3。
2. 这样从余数开始，依次加上4，得到一组数字（比如我的余数是3，那么我得到的一组数字就是：3，7，11，15，19，23，27，31，35，39）注意密码数字的最大只到39.
3. 好的，你已经得到了密码第1位数字的所有可能性了。

## 破解第二位数字
1. 还记得刚才的那个余数吗？比如我的是3，现在需要将这个余数做一个简单的数学映射。

	`0-->2`
	
	`1-->3`
	
	`2-->0`
	
	`3-->1`	
2. 比如我的余数是3，那么现在映射后的余数就是1了。
3. 同样的，用这个新的余数1，依次加上4，得到一组数字共有10个 （1，5，9，13，17，21，25，29，33，37）
4. 这10个数字就是你密码的第二位数字的所有可能性了。

## 尝试找出密码

1. 写下上面步骤的3位密码的所有可能性，一一尝试，因为密码的第一位和第二位各有10个数字，第三位已经确定，所以尝试的可能有100种组合。
2. 一般情况下你要拿着顺序记下一一组合。但是运用工程和心理学原理，以及算法中的二分查找原理，可以从密码第一位数字所有可能性数字的中间开始和第二位密码的所有可能一一组合搜素。
3. 如果不对，再从第一位密码的所有可能性的前半段中间开始，或者后半段的中间开始。
4. 不管按照什么顺序，一定要注意记录，方式混乱或者遗落任何一个密码组合。下图是我的查找示意图（我首先尝试的是23，然后是19，然后是11，最后是7，所以在进行了40多次的尝试后找到了正确的密码）。对应的密码是 **7-25-35**，哈哈，有锁可以用了！！


![master lock crack](/assets/images/2013/04/29/master_lock_crack.png)


That's it!!

